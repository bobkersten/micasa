<!-- view -->
<div class="box bg bg-{{parent.widget.properties.color || 'aqua'}}" *ngIf="!editing">
	<div class="box-header with-border">
		<div class="box-tools" *ngIf="!editing && !placeholder">
			<button type="button" (click)="parent.delete()" class="btn btn-primary btn-xs"><i class="fa fa-times"></i></button>
			<button type="button" (click)="editing=true" class="btn btn-primary btn-xs"><i class="fa fa-pencil"></i></button>
		</div>
		<h3 class="box-title" [class.empty]="!parent.widget.name">{{parent.widget.name ? parent.widget.name : 'Edit Widget'}}</h3>
	</div>

	<div class="box-body no-padding switch" (click)="toggle()">

<table class="table" [gridData]="parent.data[parent.widget.sources[0].device_id]" [gridSort]="'timestamp'" [gridOrder]="'desc'" #grid="GridDirective">
<tbody>
	<tr>
		<td>{{parent.devices[parent.widget.sources[0].device_id].value}}
		<td><i class="fa"
			[class.fa-toggle-on]="parent.devices[parent.widget.sources[0].device_id].value=='On'"
			[class.fa-toggle-off]="parent.devices[parent.widget.sources[0].device_id].value=='Off'"
		></i></td>
	</tr>
</tbody>
</table>

	</div>

	<div class="box-footer">Last Update: {{-parent.devices[parent.widget.sources[0].device_id].age | timestamp}}</div>
</div>

<!-- edit -->
<div class="box" *ngIf="editing">
	<div class="box-header with-border">
		<h3 class="box-title" [class.empty]="!parent.widget.name">{{parent.widget.name ? parent.widget.name : 'Edit Widget'}}</h3>
	</div>

	<form role="form" (ngSubmit)="parent.save()" #widgetForm="ngForm">
	<div class="box-body">

		<div class="form-group">
			<label for="widget_name">Name<span class="mandatory"> *</span></label>
			<input type="text" class="form-control" id="widget_name" placeholder="Enter name" autocomplete="off" required [(ngModel)]="parent.widget.name" name="name" #name="ngModel">
		</div>
		<div class="callout callout-danger" [hidden]="name.valid || name.pristine">A name is required!</div>
		<div class="form-group">
			<label for="widget-color">Color<span class="mandatory"> *</span></label>
			<select class="form-control" id="widget-color" required [(ngModel)]="parent.widget.properties.color" name="color" #color="ngModel">
				<option value="aqua">Aqua</option>
				<option value="blue">Blue</option>
				<option value="green">Green</option>
				<option value="red">Red</option>
				<option value="yellow">Yellow</option>
				<option value="navy">Navy</option>
				<option value="teal">Teal</option>
				<option value="olive">Olive</option>
				<option value="orange">Orange</option>
				<option value="purple">Purple</option>
			</select>
		</div>
	</div>

	<div class="box-footer" *ngIf="parent.widget.size=='large'">
		<div class="col-xs-12 col-sm-4 col-md-4 col-lg-3">
			<button type="submit" class="btn btn-success btn-block" [disabled]="!widgetForm.form.valid">Save</button>
		</div>
		<div class="col-xs-12 col-sm-4 col-sm-offset-4 col-md-4 col-md-offset-4 col-lg-3 col-lg-offset-6">
			<button type="button" class="btn btn-danger btn-block" (click)="parent.delete()" [disabled]="false">Delete</button>
		</div>
	</div>
	<div class="box-footer" *ngIf="parent.widget.size=='medium'">
		<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4">
			<button type="submit" class="btn btn-success btn-block" [disabled]="!widgetForm.form.valid">Save</button>
		</div>
		<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4 col-lg-offset-4">
			<button type="button" class="btn btn-danger btn-block" (click)="parent.delete()" [disabled]="false">Delete</button>
		</div>
	</div>
	<div class="box-footer" *ngIf="parent.widget.size=='small'">
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-6">
			<button type="submit" class="btn btn-success btn-block" [disabled]="!widgetForm.form.valid">Save</button>
		</div>
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-6">
			<button type="button" class="btn btn-danger btn-block" (click)="parent.delete()" [disabled]="false">Delete</button>
		</div>
	</div>

	</form>

</div>
